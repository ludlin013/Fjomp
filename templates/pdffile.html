<html>
<head></head>
<style>
  body{
    font-family: arial;
  }
  .wrapper{
    padding:10px;
    display: flex;
    flex-direction: column;
    margin-bottom: 100px;
  }
  .header{
    display: flex;
    flex-direction: row;
    justify-content:space-between;
  }

  .headerleft{
    height: 200px;
  }

  .toprightheader{
    width: 400px;
    border: 1px black solid;
    display:flex;
    flex-direction: row;
    border-radius: 5px;
  }

  .bottomrightheader{
    width: 400px;
    border: 1px black solid;
    display: flex;
    flex-direction: row;
    margin-top: 5px;
    border-radius: 5px;
  }

  .toprightleftheader{
    width: 30%;
    text-align: right;
    padding-right: 20px;
    font-size: 14px;
  }

  .toprightrightheader{
    width:70%;
    font-size: 14px;
  }

  .bottomrightstatic{
    text-align: right;
  }

  .bottomrightleft{
    padding: 10px;
    width: 40%;
    display: flex;
    flex-direction: row;
    margin-right: 5px;
    font-size: 14px;
  }

  .bottomrightright{
    padding: 10px;
    width: 60%;
    display: flex;
    flex-direction: row;
    margin-left: 5px;
    font-size: 14px;
  }

  .textnotes{
    display: flex;
    align-items: flex-end;
    height: 280px;
  }

  .textbox{
    margin-top: 5px;
    margin-bottom: 5px;
    border: 1px black solid;
    height: 100px;
    padding: 5px;
    border-radius: 5px;
  }

  .itembox{
    border: 1px black solid;
    min-height: 450px;
    font-size: 12px;
    border-radius: 5px;
  }
  .itemheader{
    border-bottom: 1px black solid;
    display: flex;
    flex-direction: row;
    align-items: center;

  }

  .itemrow{
    display: flex;
    flex-direction: row;
    padding: 3px;
  }

  .Partnum{
    width: 150px;
  }

  .Part{
    width: 170px;
  }

  .Qty{
    width: 40px;
    text-align: right;
  }

  .Qty2{
    width: 60px;
    text-align: right;
  }

  .Price{
    width: 75px;
    text-align: right;
  }

  .Disc{
    width: 40px;
    text-align: right;
  }

  .Disc2{
    width: 100px;
    text-align: right;
  }

  .Netvalue{
    width: 75px;
    text-align: right;
  }

  .Total{
    width: 75px;
    text-align: right;
  }

  .Backord{
    width: 40px;
  }

  .Backord2{
    text-align: right;
    width: 300px;
  }

  .Nocharge{
    width: 40px;
  }

  .righttotalvalue{
    width: 30%;
    align-items: center;
    display: flex;
    flex-direction: row;
  }

  .totalvalue{
    display: flex;
    justify-content: flex-end;
  }

  .textaligncenter{
    text-align: center;
  }

  .dynamicprice{
    align-items: center;
    display: flex;
    flex-direction: row;
    justify-content: flex-end;
    text-align: right;
    width: 100px;
  }

  .contactinfo{
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    border-top: 1px solid black;
    width: 100%;
    position: fixed;
    bottom: 0;
    background: rgb(255,255,255);
    height: 70px;
  }

  .column{
    width: 400px;
  }

  .betedig{
    margin: 0px;
    resize: none;
    width: 600px;
    height: 100px;
    font-family: arial;
    font-size: 14px;
    border: none;
  }

  .ekabcopy{
    position: absolute;
    margin:130px 0 0 60px;
    font-size: 20px;
    color:lightgrey;
    font-weight: bolder;
    text-align: center
  }

  @Page{
    margin-bottom: 50px;
  }

  @media print {
    html, body {
        height: 99%;
    }
    @page {size: portrait}
}

</style>
<body onload="docPrint()">
  <div class="wrapper">
    <p class="ekabcopy">Ekab Copy!</p>
    <div class="header">
      <div class="headerleft">
        <img src="static/pictures/ekablogo.png" height="75px" style="position: fixed;">
        <p style="font-size:20px; margin-top:80px; position: fixed;"><b>Deliverynote #: {{delivnote}}</b></p>
        <div class="textnotes"><p><b>Text/Notes</b></p></div>
      </div>
      <div class="headerright">
        <div class="toprightheader">
          <div class="toprightleftheader">
            <p><b>Cust. ID:</b></p>
            <p><b>Cust. Name:</b></p>
            <p><b>Address:</b></p>
            <p><b>ZIP / City:</b></p>
            <p><b>Cust. Ref:</b></p>
          </div>
          <div class="toprightrightheader">
            <p>{{Dict["storenum"]}}</p>
            <p>{{Dict["storename"]}}</p>
            <p>{{Dict["street"]}}</p>
            <p>{{Dict["zip"]}}&nbsp{{Dict["city"]}}</p>
            <p>{{Dict["referens"]}}</p>
          </div>
        </div>
        <div class="bottomrightheader">
          <div class="bottomrightleft">
            <div class="bottomrightstatic">
              <p><b>Date: </b></p>
              <p><b>Office: </b></p>
            </div>
            <div class="bottomrightdynamic">
              <p>&nbsp{{Dict["date"]}}</p>
              <p>&nbsp{{Dict["office"]}}</p>
            </div>
          </div>
          <div class="bottomrightright">
            <div class="bottomrightstatic">
              <p><b>Our ref: </b></p>
              <p><b>Shipping: </b></p>
            </div>
            <div class="bottomrightdynamic">
              <p>&nbsp{{name[Dict["DN_Sign"]]}}</p>
              <p>&nbsp{{Dict["freighttype"]}}</p>
            </div>
          </div>
        </div>
        </div>
      </div>
      <div class="textbox"><textarea class="betedig">{{Dict["notes"]}}</textarea></div>
      <div class="itembox">
        <div class="itemheader">
          <div class="Partnum"><b>Part #</b></div>
          <div class="Part"><b>Part</b></div>
          <div class="Qty"><b>Qty</b></div>
          <div class="Price"><b>Price</b></div>
          <div class="Disc"><b>Disc.</b></div>
          <div class="Netvalue"><b>Netvalue</b></div>
          <div class="Total"><b>Total</b></div>
          <div class="Backord textaligncenter"><b>Back ord.</b></div>
          <div class="Nocharge textaligncenter"><b>No chrg</b></div>
        </div>
        {% for x in sqlq%}
        {% if sqlq.index(x) == 22-forcount %}</div>
        <div class="itembox" style="margin-top:300px; min-height:660px;">
          <div class="itemheader">
            <div class="Partnum"><b>Part #</b></div>
            <div class="Part"><b>Part</b></div>
            <div class="Qty"><b>Qty</b></div>
            <div class="Price"><b>Price</b></div>
            <div class="Disc"><b>Disc.</b></div>
            <div class="Netvalue"><b>Netvalue</b></div>
            <div class="Total"><b>Total</b></div>
            <div class="Backord textaligncenter"><b>Back ord.</b></div>
            <div class="Nocharge textaligncenter"><b>No chrg</b></div>
          </div>
          {% endif %}
          <div class="itemrow" {% if sqlq.index(x) == 20 %}style="page-break-before: auto"{% endif %}>
            <div class="Partnum">{{x[5].strip()}}</div>
            <div class="Part">{{x[6].strip()}}<br>{% if x[7].strip() != "" %}<b style="margin: 0px; margin-left:-57px;">Serial:&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</b>{{x[7].strip()}}{% endif %}</div>
            <div class="Qty">{{x[8]}}</div>
            <div class="Price">{{x[9]}}</div>
            <div class="Disc">{{x[10]}}</div>
            <div class="Netvalue">{{x[11]}}</div>
            <div class="Total">{{x[12]}}</div>
            <div class="Backord textaligncenter">{% if x[18] != 0%}✔{% endif %}</div>
            <div class="Nocharge textaligncenter">{% if x[13] != 0%}✔{% endif %}</div>
          </div>
        {% endfor %}
        </table>
      </div>
      <div class="totalvalue">
        <div class="righttotalvalue"><p><b>Total value: </b></p><div class="dynamicprice"><p>{{total}} <b>kr</b></p></div></div>
      </div>
      <div class="contactinfo">
        <div class="column">
          <p>{{contact[0][2]}}</p>
          <p>{{contact[1][2]}}</p>
          <p>{{contact[2][2]}} {{contact[3][2]}}</p>
        </div>
        <div class="column">
          <p>Email / Web:</p>
          <p>{{contact[6][2]}}</p>
          <p>{{contact[7][2]}}</p>
        </div>
        <div class="column">
          <p>Phone:</p>
          <p>Nat. {{contact[4][2]}}</p>
          <p>Int. {{contact[9][2]}}</p>
        </div>
        <div class="column">
          <p>Org.no / VAT:</p>
          <p>{{contact[8][2]}}</p>
        </div>
      </div>
  </div>
  <div style="page-break-before:always;"></div>



  <div class="wrapper">
    <div class="header" style="margin-bottom:14px">
      <div class="headerleft">
        <div class="textnotes"><p><b>Text/Notes</b></p></div>
      </div>
      <div class="headerright">
        <div class="toprightheader">
          <div class="toprightleftheader">
            <p><b>Cust. ID:</b></p>
            <p><b>Cust. Name:</b></p>
            <p><b>Address:</b></p>
            <p><b>ZIP / City:</b></p>
            <p><b>Cust. Ref:</b></p>
          </div>
          <div class="toprightrightheader">
            <p>{{Dict["storenum"]}}</p>
            <p>{{Dict["storename"]}}</p>
            <p>{{Dict["street"]}}</p>
            <p>{{Dict["zip"]}}&nbsp{{Dict["city"]}}</p>
            <p>{{Dict["referens"]}}</p>
          </div>
        </div>
        <div class="bottomrightheader">
          <div class="bottomrightleft">
            <div class="bottomrightstatic">
              <p><b>Date: </b></p>
              <p><b>Office: </b></p>
            </div>
            <div class="bottomrightdynamic">
              <p>&nbsp{{Dict["date"]}}</p>
              <p>&nbsp{{Dict["office"]}}</p>
            </div>
          </div>
          <div class="bottomrightright">
            <div class="bottomrightstatic">
              <p><b>Our ref: </b></p>
              <p><b>Shipping: </b></p>
            </div>
            <div class="bottomrightdynamic">
              <p>&nbsp{{name[Dict["DN_Sign"]]}}</p>
              <p>&nbsp{{Dict["freighttype"]}}</p>
            </div>
          </div>
        </div>
        </div>
      </div>
      <div class="textbox"><textarea class="betedig">{{Dict["notes"]}}</textarea></div>
      <div class="itembox">
        <div class="itemheader">
          <div class="Partnum"><b>Part #</b></div>
          <div class="Part"><b>Part</b></div>
          <div class="Qty2"><b>Qty</b></div>
          <div class="Backord2"><b>Back ord.</b></div>
        </div>
        {% for x in sqlq%}
        {% if sqlq.index(x) == 22-forcount %}</div>
        <div class="itembox" style="margin-top:300px; min-height:660px;">
          <div class="itemheader">
            <div class="Partnum"><b>Part #</b></div>
            <div class="Part"><b>Part</b></div>
            <div class="Qty2"><b>Qty</b></div>
            <div class="Backord2"><b>Back ord.</b></div>
          </div>
          {% endif %}
          <div class="itemrow" {% if sqlq.index(x) == 20 %}style="page-break-before: auto"{% endif %}>
            <div class="Partnum">{{x[5].strip()}}</div>
            <div class="Part">{{x[6].strip()}}<br>{% if x[7].strip() != "" %}<b style="margin: 0px; margin-left:-57px;">Serial:&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</b>{{x[7].strip()}}{% endif %}</div>
            <div class="Qty2">{{x[8]}}</div>
            <div class="Backord2">{% if x[18] != 0%}✔{% endif %}</div>
          </div>
        {% endfor %}
        </table>
      </div>
      <div class="totalvalue">
        <div class="righttotalvalue"><p><b></b></p><div class="dynamicprice"><p><b></b></p></div></div>
      </div>
      <div class="contactinfo">
        <div class="column">
          <p>{{contact[0][2]}}</p>
          <p>{{contact[1][2]}}</p>
          <p>{{contact[2][2]}} {{contact[3][2]}}</p>
        </div>
        <div class="column">
          <p>Email / Web:</p>
          <p>{{contact[6][2]}}</p>
          <p>{{contact[7][2]}}</p>
        </div>
        <div class="column">
          <p>Phone:</p>
          <p>Nat. {{contact[4][2]}}</p>
          <p>Int. {{contact[9][2]}}</p>
        </div>
        <div class="column">
          <p>Org.no / VAT:</p>
          <p>{{contact[8][2]}}</p>
        </div>
      </div>
  </div>
  <script>
    function docPrint(){
      window.print()
      setTimeout("closePrintView()", 1000);
    }
    function closePrintView() {
      document.location.href = 'delivnotes';
    }
  </script>
</body>
</html>
