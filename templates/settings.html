<!DOCTYPE html>
<html lang="en" dir="ltr" translate="no">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEBSTAT | Settings</title>
    <link rel="stylesheet" href="static/index.css">
    <link rel="stylesheet" href="static/settings.css">
    <link rel="stylesheet" href="static/{{theme}}.css">
    <link rel="icon" href="./static/pictures/icon.ico">
  </head>
  <body>
    <div class="mobilehead" style="display:none;z-index:100000;">
      <div class="hamham" onclick="hamburger()" >
        <div id="hamtop" style="left:15px"></div>
        <div id="hammid" ></div>
        <div id="hambot" style="left:15px"></div>
      </div>
      <div id="menudim" onclick="hamburger()" style="opacity:0;display:none"></div>
    </div>
    <div class="navin">
      {% if usrtech == 1 %}
      <div class="navitemin" id="lvl3"><div id="userstatuscolor" style="background:{{usrstatus}}" ><img src="../static/pictures/{{theme}}/L3.png"></div><a id="l3" href="/lvl3status">L3 Status</a><input type="hidden" id="usrstat" value=""></div>
      {% endif %}      <a class="navitemin " href="/customers"><img src="static/pictures/{{theme}}/customers.png"><p class="noselect">Customers</p></a>
      <a class="navitemin" href="/parts"><img src="static/pictures/{{theme}}/partsv2.png"><p class="noselect">Parts</p></a>
      <a class="navitemin" href="/delivnotes"><img src="static/pictures/{{theme}}/deliverynote.png"><p class="noselect">Deliv. notes</p></a>
      <a class="navitemin" href="/ir"><img src="static/pictures/{{theme}}/ir.png"><p class="noselect">IR</p></a>
      <a class="navitemin" href="/swapouts"><img src="static/pictures/{{theme}}/swapout.png"><p class="noselect">Swapouts</p></a>
      <a class="navitemin" href="/lookup"><img src="static/pictures/{{theme}}/lookup.png"><p class="noselect">Lookup</p></a>
      <a class="navitemin active" href="/settings"><img src="static/pictures/{{theme}}/settings.png"><p class="noselect">Settings</p></a>
      <a id="navlogo" href="/landing"><img id="navlogoimg" src="/static/pictures/logo.png"></a>
    </div>
    <div class="mainwrapsettings">
      <h1 class="noselect settingsheader">Settings </h1>
      <div class="settingrow">
        <p class="settingsbranchp noselect">Branch</p>
        <div class="droplangselectsetting noselect">
          <p id="langsel"></p>
          <div class="dropmenusetting">
            <p onclick="document.cookie = 'branch=sv;expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;';location.reload()" class="settingdropmenuitem" id="sv">sv</p>
            <p onclick="document.cookie = 'branch=no;expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;';location.reload()" class="settingdropmenuitem" id="no">no</p>
            <p onclick="document.cookie = 'branch=fi;expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;';location.reload()" class="settingdropmenuitem" id="fi">fi</p>
          </div>
        </div>
      </div>
      <div class="settingrow">
        <p class="settingsbranchp noselect">Start page</p>
        <div class="droplangselectsetting noselect">
          <p id="spsel"></p>
          <div class="dropmenusetting" id="spdrop">
            <p onclick="startpage('Landing')" class="settingdropmenuitem" id="landing">Landing</p>
            <p onclick="startpage('Customers')" class="settingdropmenuitem" id="customers">Customers</p>
            <p onclick="startpage('Parts')" class="settingdropmenuitem" id="parts">Parts</p>
            <p onclick="startpage('Deliv Notes')" class="settingdropmenuitem" id="delivnotes">Deliv Notes</p>
            <p onclick="startpage('IR')" class="settingdropmenuitem" id="ir">IR</p>
            <p onclick="startpage('Swapouts')" class="settingdropmenuitem" id="swapouts">Swapouts</p>
            <p onclick="startpage('Lookup')" class="settingdropmenuitem" id="lookup">Lookup</p>
          </div>
        </div>
      </div>
      <div class="settingrow">
        <p class="settingsthemep noselect">Theme</p>
        <div class="settingthemeswitchwrap" onclick="document.cookie = 'theme={{notheme}};expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;';location.reload()">
          <img class="noselect" src="static/pictures/dark.png">
          <img class="noselect" src="static/pictures/light.png">
          <div id="settingsthemeselect">
            <div id="settingsthemeselectbutton">

            </div>
          </div>
        </div>
      </div>

      <a class="settingadminrow" href="/settings/changepassword">
        <p class="settingsthemep noselect">Change password</p>
      </a>
      <a class="settingadminrow" href="/bugreport">
        <p class="settingsthemep noselect">Report bug or request features</p>
      </a>
      <a class="settingadminrow" onclick="clearCookies()">
        <p class="settingsthemep noselect">Clear cookies</p>
      </a>
      <div class="settingrow">
        <div class="">

        </div>
        <p class="settingslogout noselect" onclick="document.cookie = 'loggedin={{username}}; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';location.reload()">Log out</p>
          <div class="">

          </div>
      </div>


      {% if auth%}

            <div style="text-align:center">
              {{server}}, {{database}}
            </div>
      <h1 class="noselect settingsheader">Maintenance</h1>
      <a class="settingadminrow" onclick="show('settingstech')">
        <p class="settingsthemep noselect">Edit Techs</p>
      </a>
      <a class="settingadminrow" onclick="show('settingsvendor')">
        <p class="settingsthemep noselect">Edit Vendors</p>
      </a>
      <a class="settingadminrow" onclick="show('settingmod')">
        <p class="settingsthemep noselect">Edit Models</p>
      </a>
      <a class="settingadminrow" onclick="show('settingsfreight')">
        <p class="settingsthemep noselect">Edit Freight Types</p>
      </a>
      <a class="settingadminrow" onclick="show('settingscharge')">
        <p class="settingsthemep noselect">Edit Chargemode</p>
      </a>
      <a class="settingadminrow" onclick="show('settingsoffice')">
        <p class="settingsthemep noselect">Edit Offices</p>
      </a>
      <a class="settingadminrow" onclick="show('settingpg')">
        <p class="settingsthemep noselect">Edit Pricegroups</p>
      </a>
      <a class="settingadminrow" onclick="show('settingsparameters')">
        <p class="settingsthemep noselect">Parameters</p>
      </a>

      <a class="settingadminrow" href="/import">
        <p class="settingsthemep noselect">Import External Data</p>
      </a>
      <a class="settingadminrow" href="/viewreport">
        <p class="settingsthemep noselect">Manage reports and requests</p>
      </a>
      {%endif%}
    </div>
    {% if auth%}

    <script src="static/settings.js">

    </script>

<div class="settingstechwrap settingscategories" id="settingsparameters" style="display:none">
  <h3 class="noselect">Company parameters</h3>
  <div class="settingstechhead">
    <p class="noselect cpvar">Variable</p>
    <p class="noselect cptyp">Type</p>
    <p class="noselect cpval">Value</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="cpform">
    {% for x in parameters %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[3]}}">
      <input readonly class="settingspg noselect cpvar" spellcheck="false" value="{{x[0].strip()}}">
      <input readonly class="settingspg noselect cptyp" spellcheck="false" value="{{x[1].strip()}}">
      <input class="settingspg noselect cpval" spellcheck="false" value="{{x[2].strip()}}" name="{{x[0].strip()}}">
    </a>
    {% endfor %}
  </form>
  <div class="pgbuttons">
    <button type="button" class="set noselect" id="cpsave" onclick="savecp()">Save</button>
  </div>

<div class="workstation noselect">
  <h3>Workstation parameters</h3>
  <label>Default mail recipient for delivery note:<input placeholder="nisse@ekabss.com" oninput="document.cookie = 'delivmail = ' + this.value+'; expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;'" value="{{mail[0]}}"></label>
  <label>Default mail recipient for IR:<input placeholder="nisse@ekabss.com" oninput="document.cookie = 'irmail = ' + this.value+'; expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;'" value="{{mail[1]}}"></label>
  <label>Default mail recipient for Projects:<input placeholder="nisse@ekabss.com" oninput="document.cookie = 'projmail = ' + this.value+'; expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;'" value="{{mail[2]}}"></label>
  <label>Path for Softone deliv.note export:<input></label>
  <label>Max length for Softone notes:<input></label>
  <label>Lead text for delv. notes:<input></label>
</div>
</div>

<div class="settingstechwrap settingscategories" id="settingpg" style="display:none">
  <h3 class="noselect">Pricegroups</h3>
  <div class="settingstechhead">
    <p class="noselect pgno">Pg no.</p>
    <p class="noselect pgname">Pg name</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="pgform">
    {% for x in pgs %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[2]}}" name="{{pgs.index(x)}}id">
      <input class="settingspg noselect pgno" spellcheck="false" value="{{x[0]}}" name="{{pgs.index(x)}}no">
      <input class="settingspg noselect pgname" spellcheck="false" value="{{x[1].strip()}}" name="{{pgs.index(x)}}name">
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to delete pricegroup {{x[1].strip().replace("\'","\\'")}}?')){rempg('{{x[2]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="pgbuttons">
    <button type="button" class="set noselect"  id="pgsave" onclick="savepg()">Save</button>
    <button type="button" class="set noselect" id="pgnew" onclick="newpg()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingmod" style="display:none">
  <h3 class="noselect">Models</h3>
  <div class="settingstechhead">
    <p class="noselect modven">Vendor</p>
    <p class="noselect modmod">Model</p>
    <p class="noselect modtyp">Type</p>
    <p class="noselect modcat">Cat.</p>
    <p class="noselect modcha">Chargemode</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="modform">
    {% for x in models %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[5]}}" name="{{models.index(x)}}id">
      <input class="settingsmod noselect modven" spellcheck="false" value="{{x[0]}}" name="{{models.index(x)}}ven">
      <input class="settingsmod noselect modmod" spellcheck="false" value="{{x[1].strip()}}" name="{{models.index(x)}}mod">
      <input class="settingsmod noselect modtyp" spellcheck="false" value="{{x[2].strip()}}" name="{{models.index(x)}}typ">
      <input class="settingsmod noselect modcat" spellcheck="false" value="{{x[3].strip()}}" name="{{models.index(x)}}cat">
      <input class="settingsmod noselect modcha" spellcheck="false" value="{{x[4]}}" name="{{models.index(x)}}cha">
      <button type="button" class="modremove" name="button" onclick="if(confirm('Are you sure you want to delete model {{x[1].strip().replace("\'","\\'")}}?')){remmod('{{x[5]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="modbuttons">
    <button type="button" class="set noselect"  id="modsave" onclick="savemod()">Save</button>
    <button type="button" class="set noselect" id="modnew" onclick="newmod()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingsoffice" style="display:none">
  <h3 class="noselect">Offices</h3>
  <div class="settingstechhead">
    <p class="noselect ofno">Office #</p>
    <p class="noselect ofname">Office Name</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="ofform">
    {% for x in office %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[5]}}" name="{{office.index(x)}}id">
      <input class="settingspg noselect ofno" spellcheck="false" value="{{x[0]}}" name="{{office.index(x)}}no">
      <input class="settingspg noselect ofname" spellcheck="false" value="{{x[1].strip()}}" name="{{office.index(x)}}name">
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to delete office {{x[1].strip().replace("\'","\\'")}}?')){remof('{{x[2]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="pgbuttons">
    <button type="button" class="set noselect"  id="ofsave" onclick="saveof()">Save</button>
    <button type="button" class="set noselect" id="ofnew" onclick="newof()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingstech" style="display:none">
  <h3 class="noselect">Technicians</h3>
  <div class="settingstechhead">
    <p class="noselect teid">ID</p>
    <p class="noselect tefirst">First name</p>
    <p class="noselect telast">Last name</p>
    <p class="noselect teoffice">Office</p>
    <p class="noselect" style="width:60px">Tech</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="teform">
    {% for x in techs %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[8]}}" name="{{techs.index(x)}}id">
      <input class="settingspg noselect teid" maxlength="3" spellcheck="false" value="{{x[0].strip()}}" name="{{techs.index(x)}}ids">
      <input class="settingspg noselect tefirst" spellcheck="false" value="{{x[1].strip()}}" name="{{techs.index(x)}}first">
      <input class="settingspg noselect telast" spellcheck="false" value="{{x[2].strip()}}" name="{{techs.index(x)}}last">
      <input class="settingspg noselect teoffice" spellcheck="false" value="{{x[4]}}" name="{{techs.index(x)}}office">
      <label class="settingspg noselect tetech">
        <input class="techcheck" type="checkbox" spellcheck="false" value="{{x[5]}}" {% if x[5] == 1 %} checked {% endif %} name="{{techs.index(x)}}tech">
      </label>
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to remove {{x[1].strip().replace("\'","\\'")}}?')){remtech('{{x[8]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="pgbuttons">
    <button type="button" class="set noselect" id="tesave" onclick="savete()">Save</button>
    <button type="button" class="set noselect" id="tenew" onclick="newte()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingsvendor" style="display:none">
  <h3 class="noselect">Vendor</h3>
  <div class="settingstechhead">
    <p class="noselect veco">Code</p>
    <p class="noselect vena">Name</p>
    <p class="noselect vecu">Currency</p>
    <p class="noselect vea1">Address 1</p>
    <p class="noselect vea2">Address 2</p>
    <p class="noselect vea3">Address 3</p>
    <p class="noselect vezi">ZIP</p>
    <p class="noselect vect">Country</p>
    <p class="noselect veph">Phone</p>
    <p class="noselect vefx">Fax</p>
    <p class="noselect vecn">Contact</p>
    <p class="noselect vema">Mail</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="veform">
    {% for x in vendors %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[12]}}" name="{{vendors.index(x)}}id">
      <input class="settingsve noselect veco" maxlength="5" spellcheck="false" value="{{x[0].strip()}}" name="{{vendors.index(x)}}code">
      <input class="settingsve noselect vena" spellcheck="false" value="{{x[1].strip()}}" name="{{vendors.index(x)}}name">
      <input class="settingsve noselect vecu" spellcheck="false" value="{{x[2].strip()}}" name="{{vendors.index(x)}}curr">
      <input class="settingsve noselect vea1" spellcheck="false" value="{{x[3]}}" name="{{vendors.index(x)}}add1">
      <input class="settingsve noselect vea2" spellcheck="false" value="{{x[4]}}" name="{{vendors.index(x)}}add2">
      <input class="settingsve noselect vea3" spellcheck="false" value="{{x[5]}}" name="{{vendors.index(x)}}add3">
      <input class="settingsve noselect vezi" spellcheck="false" value="{{x[6]}}" name="{{vendors.index(x)}}zip">
      <input class="settingsve noselect vect" spellcheck="false" value="{{x[7]}}" name="{{vendors.index(x)}}country">
      <input class="settingsve noselect veph" spellcheck="false" value="{{x[8]}}" name="{{vendors.index(x)}}phone">
      <input class="settingsve noselect vefx" spellcheck="false" value="{{x[9]}}" name="{{vendors.index(x)}}fax">
      <input class="settingsve noselect vecn" spellcheck="false" value="{{x[10]}}" name="{{vendors.index(x)}}contact">
      <input class="settingsve noselect vema" spellcheck="false" value="{{x[11]}}" name="{{vendors.index(x)}}mail">
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to remove {{x[1].strip().replace("\'","\\'")}}?')){remve('{{x[12]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="vebuttons">
    <button type="button" class="set noselect" id="vesave" onclick="saveve()">Save</button>
    <button type="button" class="set noselect" id="venew" onclick="newve()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingsfreight" style="display:none">
  <h3 class="noselect">Freight types</h3>
  <div class="settingstechhead">
    <p class="noselect feid">ID</p>
    <p class="noselect fede">Description</p>
    <p class="noselect fest">Standard</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="feform">
    {% for x in freight %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[3]}}" name="{{freight.index(x)}}id">
      <input class="settingsve noselect feid" maxlength="5" spellcheck="false" value="{{x[0].strip()}}" name="{{freight.index(x)}}rid">
      <input class="settingsve noselect fede" spellcheck="false" value="{{x[1].strip()}}" name="{{freight.index(x)}}desc">
      <input class="settingsve noselect fest" spellcheck="false" value="{{x[2]}}" name="{{freight.index(x)}}std">
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to remove {{x[1].strip().replace("\'","\\'")}}?')){remfe('{{x[3]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="vebuttons">
    <button type="button" class="set noselect" id="fesave" onclick="savefe()">Save</button>
    <button type="button" class="set noselect" id="fenew" onclick="newfe()">New</button>
  </div>


</div>

<div class="settingstechwrap settingscategories" id="settingscharge" style="display:none">
  <h3 class="noselect">Chargemode</h3>
  <div class="settingstechhead">
    <p class="noselect chty">Type</p>
    <p class="noselect chde">Description</p>
    <p class="noselect chmo">Months</p>
  </div>
  <form class="settingstechmain" action="javascript:" id="chform">
    {% for x in charge %}
    <a class="settingadmintech">
      <input type="hidden" value="{{x[3]}}" name="{{charge.index(x)}}id">
      <input class="settingsve noselect chty" maxlength="5" spellcheck="false" value="{{x[0]}}" name="{{charge.index(x)}}type">
      <input class="settingsve noselect chde" spellcheck="false" value="{{x[1].strip()}}" name="{{charge.index(x)}}desc">
      <input class="settingsve noselect chmo" spellcheck="false" value="{{x[2]}}" name="{{charge.index(x)}}month">
      <button type="button" class="pgremove" name="button" onclick="if(confirm('Are you sure you want to remove {{x[1].strip().replace("\'","\\'")}}?')){remch('{{x[3]}}');}"><img style="transform: rotate(45deg); height:25px; width:25px" src="static/pictures/{{theme}}/add.png"></button>
    </a>
    {% endfor %}
  </form>
  <div class="vebuttons">
    <button type="button" class="set noselect" id="chsave" onclick="savech()">Save</button>
    <button type="button" class="set noselect" id="chnew" onclick="newch()">New</button>
  </div>


</div>

{%endif%}

    <script src="/static/mobile.js"></script>
    <script>



    window.scrollTo(0, 0);

    try{
      document.getElementById('{{active}}').classList.add("activemaintenance");
    }catch(error){
      console.log(error);
    }

    for (var x of document.getElementsByClassName('modven')){
      //console.log(x.value);
      if(x.value == "NEWMO"){
        //console.log(x);
        x.scrollIntoView();
        x.select();
        break
      }
    }


    for (var x of document.getElementsByClassName('teid')){
      //console.log(x.value);
      if(x.value == "NET"){
        //console.log(x);
        x.scrollIntoView();
        x.select();
        break
      }
    }

    for (var x of document.getElementsByClassName('pgno')){
      //console.log(x.value);
      if(x.value == "111"){
        //console.log(x);
        x.scrollIntoView();
        x.select();
        break
      }
    }

    for (var x of document.getElementsByClassName('veco')){
      //console.log(x.value);
      if(x.value == "NEWVE"){
        //console.log(x);
        x.select();
        x.scrollIntoView();
        break
      }
    }

    for (var x of document.getElementsByClassName('feid')){
      //console.log(x.value);
      if(x.value == "111"){
        //console.log(x);
        x.select();
        x.scrollIntoView();
        break
      }
    }

    for (var x of document.getElementsByClassName('chty')){
      //console.log(x.value);
      if(x.value == "111"){
        //console.log(x);
        x.select();
        x.scrollIntoView();
        break
      }
    }

      if(document.cookie.includes("branch")){
        var cookies = document.cookie.split(";");
        for(var cookie of cookies){
          if(cookie.includes("branch")){
            var branch = cookie.replace("branch=","");
            document.getElementById("langsel").innerHTML = branch;
            document.getElementById(branch.trim()).style.display = "none";
        }
        }
      }

      document.getElementById("spsel").innerHTML = "Landing";

      if(document.cookie.includes("sp")){
        var cookies = document.cookie.split(";");
        for(var cookie of cookies){
          if(cookie.includes("sp")){
            var sp = cookie.replace("sp=","");
            document.getElementById("spsel").innerHTML = sp.slice(0,2).toUpperCase() + sp.slice(2);
            document.getElementById(sp.trim()).style.display = "none";
        }

        }
      }

      function startpage(selected){
        document.getElementById('spsel').innerHTML = selected;
        for(x of document.getElementsByClassName('settingdropmenuitem')){
          x.style.display = "block"
        }
        document.getElementById(selected.toLowerCase().replace(" ","")).style.display = "none";
        document.cookie = 'sp=' +selected.toLowerCase().replace(" ","") + ';expires=Thu, 01 Jan 2077 00:00:00 UTC; path=/;';
      }

      var theme = "{{theme}}";
      if(theme=="dark"){
      }else if(theme=="light"){
      }
      log();
      setInterval(log, 1000);

      function log(){
        if(!document.cookie.includes("loggedin=True")){
          location.reload();
        }
      }

    function show(cat){
      var all = document.getElementsByClassName('settingscategories');

      for(x of all){
        x.style.display = "none";
        x.classList.remove("activemaintenance")
      }

      document.getElementById(cat).style.display  = "block";
      document.getElementById(cat).scrollIntoView({behavior:"smooth"});

      document.cookie = "active = " + cat

    }

    //show('settingsmodel')
    </script>
  </body>
</html>
